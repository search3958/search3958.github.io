<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search3958</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Unbounded:wght@200..900&family=Work+Sans:ital,wght@0,100..900;1,100..900&family=Zen+Kaku+Gothic+New&display=swap" rel="stylesheet">
    <script type="importmap">
    {
      "imports": {
        "@material/web/": "https://esm.run/@material/web/"
      }
    }
  </script>
  <script type="module">
    import '@material/web/all.js';
    import {styles as typescaleStyles} from '@material/web/typography/md-typescale-styles.js';

    document.adoptedStyleSheets.push(typescaleStyles.styleSheet);
  </script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Work Sans","Zen Kaku Gothic New",sans-serif;
            line-height: 1.5;
        }
        :root{
          --md-ripple-hover-color:#0000;
          --header-width: 220px;
    --header-expanded-width: 220px;

        }
        body {
            min-height: 100vh;
            background: #F6F6F6;
            overflow-x: hidden;
        }
        a{
          color:#000;
    text-decoration: none;
        }
        h1{
          font-family: "Unbounded", sans-serif;
  font-optical-sizing: auto;
  font-weight: 400;
  font-size:3.5em;
  margin-bottom:24px;
  position:relative;
  z-index:6;
        }
        .toph2{
          position:relative;
          bottom:16px;
  z-index:6;
  font-weight: 400;
  color:#fffa;
        }
        button {
            box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 0px 5px 16px -7px rgba(0, 0, 0, 0.4), 0px 1px 10px -7px rgba(0, 0, 0, 0.29);
            padding: 8px 12px;
            border: none;
            border-radius: 100px;
            position: relative;
            --md-ripple-pressed-color:#0007;
            background:#efefef99;
            backdrop-filter: blur(4px);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.7), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.7), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.35), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.5), 0px 8px 20px -7px rgba(0, 0, 0, 0.5), 0px 2px 14px -7px rgba(0, 0, 0, 0.4);
        }

        .primary {
          color:#fff;
          background:#007AFFD0;
          --md-ripple-pressed-color:#88ffff;
        }

        .primary:hover {
            background:#0088FFE0;
        }

        #lensFx_canvas {
            position: fixed;
            top: 24px;
            left: 24px;
            width: var(--header-width);
            height: 80px;
            border-radius: 40px;
            z-index: 10;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        .header {
            position: fixed;
            top: 24px;
            left: 24px;
            width: var(--header-width);
            height: 80px;
            border-radius: 40px;
            z-index: 11;
            transition: all 0.6s cubic-bezier(.2,0,0,1);
            background: #fff5;
            backdrop-filter: blur(3px);
            display: flex;
            box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 0px 5px 16px -7px rgba(0, 0, 0, 0.4), 0px 1px 10px -7px rgba(0, 0, 0, 0.29);
            overflow: hidden;
            flex-wrap: nowrap;
            white-space: nowrap;
            align-items: center;
            gap: 16px;
            padding: 0 16px;
        }
          a{
            display:block;
          }
        .header.active {
          width: var(--header-expanded-width);
        }
        .btnflex{
          display:flex;
          gap:8px;
        }
        .first{
              background-size: cover;
    background-position: center;
          background-image:
  linear-gradient(rgba(0, 0, 0, 0.2), rgba(0, 0, 0, 0.2)),
  url(https://search3958.github.io/newtab/bgimg/bg1.webp);
            padding:24px;
          padding-top:120px;
          position:relative;
          color:#fff;
        }
        .prg-blur {
  position: absolute;
  bottom: 0;
  left: 0;
  height: 200px;
  width: 100%;
  background: rgba(255, 255, 255, 0.01);

}

.prg-blur::before {
  position: absolute;
  inset: 0;
  content: "";
  backdrop-filter: blur(0.3rem);
  mask-image: linear-gradient(
    to bottom,
    rgb(0 0 0 / 0%) 0%,
    rgb(0 0 0 / 4.9%) 7.75%,
    rgb(0 0 0 / 10.4%) 11.25%,
    rgb(0 0 0 / 45%) 23.55%,
    rgb(0 0 0 / 55%) 26.45%,
    rgb(0 0 0 / 89.6%) 38.75%,
    rgb(0 0 0 / 95.1%) 42.25%,
    rgb(0 0 0 / 100%) 50%
  );
}

.prg-blur::after {
  position: absolute;
  inset: 0;
  top: 25%;
  content: "";
  backdrop-filter: blur(0.2rem);
  mask-image: linear-gradient(
    to bottom,
    rgb(0 0 0 / 0%) 0%,
    rgb(0 0 0 / 4.9%) 15.5%,
    rgb(0 0 0 / 10.4%) 22.5%,
    rgb(0 0 0 / 45%) 47.1%,
    rgb(0 0 0 / 55%) 52.9%,
    rgb(0 0 0 / 89.6%) 77.5%,
    rgb(0 0 0 / 95.1%) 91.9%,
    rgb(0 0 0 / 100%) 100%
  );
}

.header-toggle {
            width: 48px;
            height: 48px;
            border-radius: 24px;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: auto;
        }
        .flexboard {
    display: flex;
    width: 100%;
    gap: 20px;
    overflow-x: auto;
    padding: 16px;
    box-sizing: border-box;
    scroll-behavior: smooth;
}

.flexboard::-webkit-scrollbar {
    height: 6px;
}

.flexboard::-webkit-scrollbar-track {
    background: rgba(0,0,0,0.1);
    border-radius: 3px;
}

.flexboard::-webkit-scrollbar-thumb {
    background: rgba(0,122,255,0.3);
    border-radius: 3px;
}

.flexboard::-webkit-scrollbar-thumb:hover {
    background: rgba(0,122,255,0.5);
}

.card {
    position: relative;
    box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 
                0px 8px 24px -8px rgba(0, 0, 0, 0.15), 
                0px 2px 16px -8px rgba(0, 0, 0, 0.08);
    padding: 24px;
    width: 280px;
    border-radius: 40px;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    flex-shrink: 0;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    overflow: hidden;
    cursor: pointer;
    border: 1px solid rgba(255,255,255,0.8);
}

@keyframes gradientShift {
    0%, 100% { background-position: 200% 0; }
    50% { background-position: -200% 0; }
}

.card:hover {
    transform: translateY(-8px) scale(1.02);
    box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.7), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.7), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.35), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.5), 
                0px 20px 40px -8px rgba(0, 0, 0, 0.25), 
                0px 8px 32px -8px rgba(0, 0, 0, 0.15);
    background: linear-gradient(135deg, #ffffff 0%, #f0f2f5 100%);
}

.card-icon {
    width: 56px;
    height: 56px;
    border-radius: 20px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-bottom: 16px;
    background: linear-gradient(135deg, #007AFF20, #00D4FF20);
    border: 1px solid rgba(0,122,255,0.1);
    transition: all 0.3s ease;
}

.card:hover .card-icon {
    background: linear-gradient(135deg, #007AFF30, #00D4FF30);
    border-color: rgba(0,122,255,0.2);
    transform: scale(1.1);
}

.card-icon .material-symbols-outlined {
    font-size: 28px;
    color: #007AFF;
}

.card-title {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 8px;
    color: #1a1a1a;
    letter-spacing: -0.5px;
}

.card-text {
    margin-bottom: 20px;
    color: #666;
    font-size: 14px;
    line-height: 1.5;
}

.card-tag {
    display: inline-block;
    background: rgba(0,122,255,0.1);
    color: #007AFF;
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 12px;
    font-weight: 500;
    margin-bottom: 16px;
    border: 1px solid rgba(0,122,255,0.1);
}

.card button {
    width: 100%;
    padding: 12px;
    font-weight: 500;
    font-size: 14px;
}

.sc-title {
    padding: 32px 16px 16px 16px;
    font-size: 28px;
    font-weight: 600;
    color: #1a1a1a;
    letter-spacing: -0.5px;
}

.section {
    margin-bottom: 40px;
}

.grid-cards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 24px;
    padding: 16px;
}
.grid-card {
    position: relative;
    box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 
                0px 8px 24px -8px rgba(0, 0, 0, 0.15);
    padding: 24px;
    border-radius: 40px;
    background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
    transition: all 0.3s ease;
    border: 1px solid rgba(255,255,255,0.8);
}

.grid-card:hover {
    transform: translateY(-4px);
    box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.7), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.7), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.35), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.5), 
                0px 16px 32px -8px rgba(0, 0, 0, 0.2);
}

.grid-card h3 {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 12px;
    color: #1a1a1a;
}

.grid-card p {
    color: #666;
    line-height: 1.6;
    margin-bottom: 16px;
}

.feature-list {
    list-style: none;
    margin: 16px 0;
}

.feature-list li {
    padding: 8px 0;
    color: #666;
    position: relative;
    padding-left: 20px;
}

.feature-list li::before {
    content: '✓';
    position: absolute;
    left: 0;
    color: #007AFF;
    font-weight: bold;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 20px;
    margin: 24px 0;
}

.stat-item {
    text-align: center;
    padding: 20px;
    background: rgba(0,122,255,0.05);
    border-radius: 16px;
    border: 1px solid rgba(0,122,255,0.1);
}

.stat-number {
    font-size: 24px;
    font-weight: 700;
    color: #007AFF;
    display: block;
}

.stat-label {
    font-size: 12px;
    color: #666;
    margin-top: 4px;
}
.btnflex{
  display:flex;
}
.setup-steps{
  box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 
                0px 8px 24px -8px rgba(0, 0, 0, 0.15);
}
@media (max-width: 768px) {
    .grid-cards {
        grid-template-columns: 1fr;
        padding: 16px;
    }
    
    .card {
        width: 260px;
    }
    
    .stats-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}
      .link-icon {
        width: 48px;
        height: 48px;
        border-radius: 16px;
        object-fit: cover;
        margin-bottom: 10px;
        box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 0px 5px 16px -7px rgba(0, 0, 0, 0.4);
        background: #fff;
        display: inline-block;
      }
      .link-collection-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 4px;
        text-align: center;
        min-height: 120px;
      }
      .link-collection-title {
        font-weight: bold;
        font-size: 1em;
        margin-top: 2px;
        color: #222;
        word-break: break-all;
      }
      .svgimg{
        margin:0px;
        width:380px;
        display:block;
      }
      .setup-imgs {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 12px;
        margin-top: 12px;
        flex-wrap: wrap;
      }
      @media (max-width: 600px) {
        .setup-imgs {
          flex-direction: column;
          gap: 8px;
        }
      }
      .setup-imgs .svgimg {
        max-width: 320px;
        width: 100%;
        border-radius: 18px;
        box-shadow: 0 2px 12px -4px #007aff22;
        margin: 0;
        display: block;
      }
    </style>
</head>
<body>
  
  <div class="first">
    <div class="prg-blur"></div>
    <h1>Newtab v4</h1>
    <h2 class="toph2">革新的な新しいタブ</h2>
    <div class="btnflex">
      <button class="primary" onclick="window.location.href='https://search3958.github.io/newtab/?value=try'">今すぐ確認<md-ripple></md-ripple></button>
    </div>
  </div>

  <div class="section" style="margin-top:24px;">
    <h2 class="sc-title" style="font-size:22px;">設定方法</h2>
    <div class="setup-steps" style="width:calc(100vw - 32px);margin:16px auto;padding:32px 20px 24px 20px;background:linear-gradient(135deg,#fff 80%,#f8f9fa 100%);border-radius:32px;">
      <ol style="list-style:none;padding:0;margin:0;">
        <li style="margin-bottom:32px;">
          <div style="display:flex;align-items:flex-start;gap:18px;">
            <div style="min-width:38px;min-height:38px;background:#007AFF11;color:#007AFF;font-weight:700;font-size:1.3em;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px -4px #007aff22;">1</div>
            <div>
              <span style="font-weight:600;color:#007AFF;">New Tab Redirect</span>をChromeに追加します。<br>
              <a style="color:#007AFF;font-weight:500;" href="https://chromewebstore.google.com/detail/icpgjfneehieebagbmdbhnlpiopdcmna?utm_source=item-share-cb" target="_blank">Chrome ウェブストアで開く</a>
              <div class="setup-imgs">
                <img class="svgimg" src="https://search3958.github.io/i/newtab/1.svg" alt="step1">
                <img class="svgimg" src="https://search3958.github.io/i/newtab/2.svg" alt="step2">
              </div>
            </div>
          </div>
        </li>
        <li>
          <div style="display:flex;align-items:flex-start;gap:18px;">
            <div style="min-width:38px;min-height:38px;background:#007AFF11;color:#007AFF;font-weight:700;font-size:1.3em;border-radius:16px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px -4px #007aff22;">2</div>
            <div>
              インストールが完了したら、<span style="font-weight:600;">Set Options</span>をクリックし<br>
              <span style="background:#f6f8fa;border-radius:8px;padding:2px 8px;color:#007AFF;font-weight:600;">https://search3958.github.io/newtab/</span> を入力して <span style="font-weight:600;">Save</span> します。
              <div class="setup-imgs">
                <img class="svgimg" src="https://search3958.github.io/i/newtab/3.svg" alt="step3">
                <img class="svgimg" src="https://search3958.github.io/i/newtab/4.svg" alt="step4">
              </div>
            </div>
          </div>
        </li>
      </ol>
      <p style="color:#888;font-size:0.97em;margin-top:24px;">※ 他の端末でも同じ設定を行ってください。</p>
    </div>
  </div>

  <div class="section" style="margin-top:24px;">
    <h2 class="sc-title" style="font-size:22px;">Newtab4とは？</h2>
    <div class="grid-cards" style="grid-template-columns:1fr;">
      <div class="grid-card">
        <p>
          よく使うサイトにすぐアクセスできるようにするために作成しました。<br>
多くの方にも便利に使っていただきたいので無料で公開しています！<br>
今後も新機能などのアップデートはどんどん配信されます
        </p>
      </div>
    </div>
  </div>

  <!-- 主なアップデート履歴をタイムラインカードで改善 -->
  <div class="section" style="margin-top:24px;">
    <h2 class="sc-title" style="font-size:22px;">主なアップデート履歴</h2>
    <div class="timeline-container">
      <div class="timeline">
        <!-- 2025/04/28 v4 -->
        <div class="timeline-item">
          <div class="timeline-marker">
            <span class="timeline-version">v4</span>
            <span class="timeline-date">2025/04/28</span>
          </div>
          <div class="timeline-card">
            <div class="timeline-title">メジャーアップデート</div>
            <div class="timeline-desc">
              WinUI3のようなデザインから独自のシンプルなデザインに変更。また、Appleのliquid glass風デザインを追加<br>
              ショートカットをコンパクトにしてより見やすく変更。<br>
              また，v3で利用できなくなっていたミニツールの復活
            </div>
          </div>
        </div>
        <!-- 2025/03/21 v3.5 -->
        <div class="timeline-item">
          <div class="timeline-marker">
            <span class="timeline-version">v3.5</span>
            <span class="timeline-date">2025/03/21</span>
          </div>
          <div class="timeline-card">
            <div class="timeline-title">メジャーアップデート</div>
            <div class="timeline-desc">
              AI Search（Google Gemini搭載）を追加。より具体的かつ幅広い検索が可能に。<br>
              デザインをApple風からOneUIベースに刷新、わかりやすさ向上。<br>
              ウィジェット機能追加、Newtab設定をコントロールパネルに統合。<br>
              標準壁紙選択UIを改善。
            </div>
          </div>
        </div>
        <!-- 2025/02/12 v3 -->
        <div class="timeline-item">
          <div class="timeline-marker">
            <span class="timeline-version">v3</span>
            <span class="timeline-date">2025/02/12</span>
          </div>
          <div class="timeline-card">
            <div class="timeline-title">メジャーアップデート</div>
            <div class="timeline-desc">
              3Dアイコンを新デザイン化。色変更対応、ダークモードも最適化。<br>
              時計・カスタマイズ・概要を小型ボックスにまとめ、コンパクト化。<br>
              バッテリー残量警告表示を追加。<br>
              デザインをMaterial3風からApple風透明デザインに変更。
            </div>
          </div>
        </div>
        <!-- 2025/01/11 -->
        <div class="timeline-item">
          <div class="timeline-marker">
          </div>
          <div class="timeline-card">
            <div class="timeline-title">検索エンジン選択機能追加</div>
            <div class="timeline-desc">
              検索エンジン選択機能を追加。<br>
              （Google / Bing / Yahoo / DuckDuckGo / NAVER / Naenara）
            </div>
          </div>
        </div>
        <!-- 2024/12/05 -->
        <div class="timeline-item">
          <div class="timeline-marker">
          </div>
          <div class="timeline-card">
            <div class="timeline-title">Gemini検索機能追加</div>
            <div class="timeline-desc">
              ダイアログ表示の不具合を修正。<br>
              ログイン不要で使えるGemini検索機能を追加。
            </div>
          </div>
        </div>
        <!-- 2024/12/03 v2.1 -->
        <div class="timeline-item">
          <div class="timeline-marker">
            <span class="timeline-version">v2.1</span>
            <span class="timeline-date">2024/12/03</span>
          </div>
          <div class="timeline-card">
            <div class="timeline-title">メジャーアップデート</div>
            <div class="timeline-desc">
              背景に画像を設定できる機能を追加。
            </div>
          </div>
        </div>
        <!-- 2024/11/14 -->
        <div class="timeline-item">
          <div class="timeline-marker">
          </div>
          <div class="timeline-card">
            <div class="timeline-title">URL直接入力復活</div>
            <div class="timeline-desc">
              検索ボックスから直接URLを入力してアクセスできる機能を復活。
            </div>
          </div>
        </div>
        <!-- 2024/11/02 v2 -->
        <div class="timeline-item">
          <div class="timeline-marker">
            <span class="timeline-version">v2</span>
            <span class="timeline-date">2024/11/02</span>
          </div>
          <div class="timeline-card">
            <div class="timeline-title">メジャーアップデート</div>
            <div class="timeline-desc">
              サイト全体を再構築し、コードを簡素化 → 読み込み速度が大幅向上。<br>
              履歴機能追加、カスタマイズUI改善、アニメーション強化、一部デザイン変更。
            </div>
          </div>
        </div>
        <!-- 2024/10/24 -->
        <div class="timeline-item">
          <div class="timeline-marker">
          </div>
          <div class="timeline-card">
            <div class="timeline-title">アニメーション強化</div>
            <div class="timeline-desc">
              リップルエフェクトやウィンドウアニメーションを追加し、全体の動きを強化。<br>
              その他、細かい微調整を実施。
            </div>
          </div>
        </div>
      </div>
      <div style="color:#888;font-size:0.97em;margin-top:18px;text-align:right;">
        ※ 2024/10/12以降の更新情報のみ掲載しています。
      </div>
    </div>
  </div>
  <style>
    /* Timeline styles */
    .timeline-container {
      width: 100%;
      padding: 0 0 8px 0;
      margin: 0 auto;
      max-width: 900px;
    }
    .timeline {
      position: relative;
      margin: 0 0 0 0;
      padding-left: 32px;
      border-left: 3px solid #e5e5e5;
    }
    .timeline-item {
      display: flex;
      align-items: flex-start;
      margin-bottom: 32px;
      position: relative;
    }
    .timeline-marker {
      position: relative;
      left: -20px;
      width: 70px;
      min-width: 70px;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      z-index: 2;
    }


    .timeline-version {
      display: inline-block; 
      color: #fff;
    background: #007AFFD0;
      font-size: 1.1em;
      border-radius: 200px;
      padding: 2px 14px;
      margin-bottom: 6px;
       box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 0px 5px 16px -7px rgba(0, 0, 0, 0.4), 0px 1px 10px -7px rgba(0, 0, 0, 0.29);
      min-width: 38px;
      text-align: center;
      
    }
    .timeline-date {
      color: #696969cc;
      font-size: 0.93em;
      margin-bottom: 2px;
      border-radius: 8px;
      padding: 2px 8px;
      min-width: 60px;
      text-align: center;
    }
    .timeline-card {
      background: linear-gradient(135deg,#fff 80%,#f8f9fa 100%);
      border-radius: 24px;
      
  box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), 
                inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), 
                inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 
                0px 8px 24px -8px rgba(0, 0, 0, 0.15);
      padding: 18px 22px 14px 22px;
      margin-left: 18px;
      min-width: 0;
      flex: 1;
      border: 1px solid #f0f4ff;
      position: relative;
      z-index: 1;
      transition: box-shadow 0.2s;
    }
    .timeline-title {
      font-size: 1.1em;
      margin-bottom: 6px;
      letter-spacing: -0.5px;
    }
    .timeline-desc {
      color: #333;
      font-size: 0.98em;
      line-height: 1.7;
    }
    /* Timeline vertical line dot */
    .timeline-item::before {
      content: '';
      position: absolute;
      left: -42px;
      top: 7px;
      width: 14px;
      height: 14px;
    background: #007AFFD0;
      border-radius: 50%;
box-shadow: inset -2px 2px 2px -1px rgba(255, 255, 255, 0.6), inset 2px -2px 2px -1px rgba(255, 255, 255, 0.6), inset 4px 4px 2px -5px rgba(0, 0, 0, 0.28), inset -4px -4px 2px -5px rgba(0, 0, 0, 0.4), 0px 5px 16px -7px rgba(0, 0, 0, 0.4), 0px 1px 10px -7px rgba(0, 0, 0, 0.29);
      z-index: 3;
    }
    @media (max-width: 700px) {
      .timeline-container {
        padding: 0 2vw;
      }
      .timeline {
        padding-left: 18px;
      }
      .timeline-marker {
        left: -18px;
        width: 56px;
        min-width: 56px;
      }
      .timeline-item::before {
        left: -22px;
        width: 12px;
        height: 12px;
      }
      .timeline-card {
        padding: 14px 10px 10px 14px;
        font-size: 0.98em;
      }
    }
    @media (max-width: 500px) {
      .timeline-container {
        padding: 0 1vw;
      }
      .timeline {
        padding-left: 10px;
      }
      .timeline-marker {
        left: -20px;
        width: 38px;
        min-width: 38px;
      }
      .timeline-item::before {
        left: -12px;
        width: 10px;
        height: 10px;
      }
      .timeline-card {
        padding: 10px 4px 8px 8px;
        font-size: 0.95em;
      }
    }
  </style>
    <canvas id="lensFx_canvas" data-html2canvas-ignore="true"></canvas>
<div class="header" data-html2canvas-ignore="true">
  <button class="header-toggle" onclick="window.location.href='https://search3958.github.io/'">
    
<svg width="49" height="70" viewBox="0 0 49 70" fill="none" xmlns="http://www.w3.org/2000/svg">
<rect width="48.2759" height="48.2759" rx="24.1379" fill="url(#paint0_radial_157_20)"/>
<rect y="21.7241" width="48.2759" height="48.2759" rx="24.1379" fill="url(#paint1_radial_157_20)"/>
<defs>
<radialGradient id="paint0_radial_157_20" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(24.1379 48.2759) rotate(-90) scale(53.5058)">
<stop stop-color="#185AF2" stop-opacity="0.05"/>
<stop offset="0.519286" stop-color="#2161F4" stop-opacity="0.33"/>
<stop offset="0.673134" stop-color="#2564F5" stop-opacity="0.507702"/>
<stop offset="1" stop-color="#326EF7"/>
</radialGradient>
<radialGradient id="paint1_radial_157_20" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(24.1379 70) rotate(-90) scale(53.5058)">
<stop stop-color="#326EF7"/>
<stop offset="0.5" stop-color="#004DFF"/>
<stop offset="1" stop-color="#002780"/>
</radialGradient>
</defs>
</svg>

    <md-ripple></md-ripple>
  </button>
  <a href="https://search3958.github.io/i/newtab/">Newtab</a>
  <a href="https://search3958.github.io/i/tools/">ツール</a>
</div>
    <div class="debug-info" id="debugInfo"></div>

<script>
  const lensFx_canvas   = document.getElementById("lensFx_canvas");
  const lensFx_ctx      = lensFx_canvas.getContext("2d");
  const debugInfo       = document.getElementById("debugInfo");

  const LAYERS           = 10;
  const MIN_ZOOM         = 1.8;
  const MAX_ZOOM         = 1;
  const SHRINK_STEP      = 4;
  const CAPTURE_INTERVAL = 1000;
  const SCROLL_CAPTURE_INTERVAL = 5000;

  let lensFx_img     = null;
  let scrollOffsetY  = 0;
  let captureTimer   = null;
  let autoUpdate     = true;
  let showDebug      = false;
  let isScrolling    = false;
  let scrollTimeout  = null;

  function safeInverseEasing(t) {
    const ε = 0.05;
    const v = 1/(t+ε) - 1/ε;
    const maxV = 1/(1+ε) - 1/ε;
    return v/maxV;
  }

  function radiusEasing(t) {
    return 0.3 + 0.7*(1 - t*t);
  }

  function updateCanvasSize(canvas, ctx) {
    const rect = canvas.getBoundingClientRect();
    const dpr  = window.devicePixelRatio||1;
    canvas.width  = rect.width * dpr;
    canvas.height = rect.height * dpr;
    ctx.setTransform(1,0,0,1,0,0);
    ctx.scale(dpr,dpr);
  }

  function getRadius(canvas) {
    return parseFloat(getComputedStyle(canvas).borderRadius) || 0;
  }

  function drawLens(img, ctx, canvasElem) {
    if (!img) return;
    
    const imgW = img.width;
    const imgH = img.height;
    const rect = canvasElem.getBoundingClientRect();
    const wLens = rect.width;
    const hLens = rect.height;
    const radius = getRadius(canvasElem);

    const canvasScreenX = rect.left;
    const canvasScreenY = rect.top + scrollOffsetY;

    const viewportW = window.innerWidth;
    const viewportH = document.documentElement.scrollHeight;
    
    const scaleX = imgW / viewportW;
    const scaleY = imgH / viewportH;
    
    const imgCenterX = (canvasScreenX + wLens/2) * scaleX;
    const imgCenterY = canvasScreenY * scaleY + (hLens/2) * scaleY;

    ctx.clearRect(0, 0, canvasElem.width, canvasElem.height);

    if (showDebug) {
      debugInfo.innerHTML = `
        Canvas位置: (${canvasScreenX.toFixed(0)}, ${canvasScreenY.toFixed(0)})<br>
        画像サイズ: ${imgW} x ${imgH}<br>
        ビューポート: ${viewportW} x ${viewportH}<br>
        スケール: ${scaleX.toFixed(3)} x ${scaleY.toFixed(3)}<br>
        画像上中心: (${imgCenterX.toFixed(0)}, ${imgCenterY.toFixed(0)})
      `;
    }

    for (let i = 0; i < LAYERS; i++) {
      const t = i / (LAYERS - 1);
      const zoom = MIN_ZOOM + safeInverseEasing(t) * (MAX_ZOOM - MIN_ZOOM);
      const w = wLens - i * SHRINK_STEP;
      const h = hLens - i * SHRINK_STEP;
      const dx = (wLens - w) / 2;
      const dy = (hLens - h) / 2;
      
      // 拡大する範囲を計算
      const sw = (w / zoom) * scaleX;
      const sh = (h / zoom) * scaleY;
      const sx = imgCenterX - sw / 2;
      const sy = imgCenterY - sh / 2;
      
      const rad = radius * radiusEasing(t);

      // クリッピングパスを作成
      ctx.save();
      ctx.beginPath();
      ctx.moveTo(dx + rad, dy);
      ctx.lineTo(dx + w - rad, dy);
      ctx.quadraticCurveTo(dx + w, dy, dx + w, dy + rad);
      ctx.lineTo(dx + w, dy + h - rad);
      ctx.quadraticCurveTo(dx + w, dy + h, dx + w - rad, dy + h);
      ctx.lineTo(dx + rad, dy + h);
      ctx.quadraticCurveTo(dx, dy + h, dx, dy + h - rad);
      ctx.lineTo(dx, dy + rad);
      ctx.quadraticCurveTo(dx, dy, dx + rad, dy);
      ctx.closePath();
      ctx.clip();

      // 画像を描画
      ctx.drawImage(img, sx, sy, sw, sh, dx, dy, w, h);
      ctx.restore();

      // 境界線を描画
      ctx.lineWidth = 1;
      ctx.strokeStyle = `rgba(255,255,255,${0.005 + 0.02 * t})`;
      ctx.beginPath();
      ctx.moveTo(dx + rad, dy);
      ctx.lineTo(dx + w - rad, dy);
      ctx.quadraticCurveTo(dx + w, dy, dx + w, dy + rad);
      ctx.lineTo(dx + w, dy + h - rad);
      ctx.quadraticCurveTo(dx + w, dy + h, dx + w - rad, dy + h);
      ctx.lineTo(dx + rad, dy + h);
      ctx.quadraticCurveTo(dx, dy + h, dx, dy + h - rad);
      ctx.lineTo(dx, dy + rad);
      ctx.quadraticCurveTo(dx, dy, dx + rad, dy);
      ctx.closePath();
      ctx.stroke();
    }
  }

  function renderAll() {
    updateCanvasSize(lensFx_canvas, lensFx_ctx);
    drawLens(lensFx_img, lensFx_ctx, lensFx_canvas);
  }

  async function captureFullPage() {
    try {
      const fullW = document.documentElement.scrollWidth;
      const fullH = document.documentElement.scrollHeight;
      const canvas = await html2canvas(document.body, {
        useCORS: true,
        allowTaint: true,
        scale: 1,
        width: fullW,
        height: fullH,
        scrollX: 0,
        scrollY: 0,
        backgroundColor: null
      });
      const img = new Image();
      img.onload = () => {
        lensFx_img = img;
        renderAll();
      };
      img.src = canvas.toDataURL();
    } catch (e) {
      console.error(e);
    }
  }

  // コントロール関数
  function updateLensEffect() {
    captureFullPage();
  }

  function toggleAutoUpdate() {
    autoUpdate = !autoUpdate;
    if (autoUpdate) {
      captureTimer = setInterval(captureFullPage, CAPTURE_INTERVAL);
    } else {
      clearInterval(captureTimer);
    }
  }

  function toggleDebug() {
    showDebug = !showDebug;
    debugInfo.style.display = showDebug ? 'block' : 'none';
    if (showDebug) {
      renderAll();
    }
  }

  // 初期化
  captureFullPage();
  updateCaptureTimer();

  window.addEventListener("scroll", () => {
    scrollOffsetY = window.scrollY;
    renderAll();
    
    // スクロール中の処理
    isScrolling = true;
    clearTimeout(scrollTimeout);
    // ↓ ここで必ずintervalをクリア
    clearInterval(captureTimer);
    updateCaptureTimer();

    scrollTimeout = setTimeout(() => {
      isScrolling = false;
      updateCaptureTimer();
    }, 150);
  });

  function updateCaptureTimer() {
    // 既存のintervalを必ずクリア
    if (captureTimer) {
      clearInterval(captureTimer);
      captureTimer = null;
    }
    if (autoUpdate) {
      const interval = isScrolling ? SCROLL_CAPTURE_INTERVAL : CAPTURE_INTERVAL;
      captureTimer = setInterval(captureFullPage, interval);
    }
  }

  window.addEventListener("resize", renderAll);
  
  // ResizeObserver
  if (window.ResizeObserver) {
    const resizeObserver = new ResizeObserver(() => {
      syncWidth();
    });
    
    // headerとcanvasの両方を監視
    resizeObserver.observe(header);
    resizeObserver.observe(lensFx_canvas);
  }


  const header = document.querySelector('.header');
  let isExpanded = false;

// headerの幅をlensFx_canvasに同期させる関数
function syncWidth() {
  lensFx_canvas.style.width = `${header.offsetWidth}px`;
  renderAll();
}

// ResizeObserverの設定
if (window.ResizeObserver) {
  const resizeObserver = new ResizeObserver(() => {
    syncWidth();
  });
  
  // headerとcanvasの両方を監視
  resizeObserver.observe(header);
  resizeObserver.observe(lensFx_canvas);
}

// MutationObserverの設定
const mutationObserver = new MutationObserver(() => {
  syncWidth();
});

// headerのstyle属性の変更を監視
mutationObserver.observe(header, {
  attributes: true,
  attributeFilter: ['style']
});

// 初期同期
syncWidth();

// ヘッダーの開閉処理を追加
const headerToggle = document.querySelector('.header-toggle');

headerToggle.addEventListener('click', () => {
  header.classList.toggle('active');
  syncWidth(); // 既存の同期関数を呼び出し
});
</script>


<!-- フッター追加 -->
<footer style="width:100%;text-align:center;padding:32px 0 16px 0;color:#888;font-size:14px;">
  © Search 3958
</footer>

</body>
</html>