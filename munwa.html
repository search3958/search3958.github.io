<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>문화텏트</title>
  <link href="https://fonts.googleapis.com/css2?family=M+PLUS+1p:wght@400;700&display=swap" rel="stylesheet">
  <style>
    :root{--preview-h:20vh; font-family:"M PLUS 1p", system-ui,-apple-system,"Segoe UI",Roboto,'Yu Gothic',"Hiragino Kaku Gothic ProN",Meiryo,Arial}
    html,body{height:100%;margin:0;background:#060609;color:#fff;overflow:hidden}
    .screen{display:flex;flex-direction:column;width:100%;height:100vh;align-items:center;justify-content:flex-start;overflow:hidden}
    .page-current,.page-next{box-sizing:border-box;border-radius:10px;overflow:hidden;width:96%;max-width:1400px;}
    .page-current{padding:4px;display:flex;flex-direction:column;gap:6px;flex-grow:1;height:calc(100% - var(--preview-h));}
    .page-next{height:var(--preview-h);margin-bottom:4px;padding:4px;display:flex;align-items:center;justify-content:center;background:#111827;}
    .block{border-radius:6px;padding:6px;overflow:hidden}
    .block .text{width:100%;text-align:center;white-space:pre-wrap;font-weight:400;line-height:1.3}
    .blk-Orange{background:#5c2a00;color:#ffcc80;font-size:clamp(20px,4vw,36px)}
    .blk-Green{background:#0f3d1a;color:#a8f0c2;font-size:clamp(20px,4vw,36px)}
    .blk-Pink{background:#4d0d2a;color:#ffb7dc;font-size:clamp(20px,4vw,36px)}
    .blk-Text{background:#111827;color:#eaf6ff;display:flex;align-items:center;justify-content:center;font-size:clamp(28px,6vw,64px);flex-grow:1;}
    .blk-Text .text{flex-grow:1; display:flex; align-items:center; justify-content:center; height:100%;}
    .page-next .text{font-size:clamp(16px,3vw,24px)}
    .controls{position:fixed;right:12px;bottom:12px;display:flex;gap:8px;z-index:99}
    .btn{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);color:#fff;padding:6px 10px;border-radius:8px;cursor:pointer;font-weight:700}
    .meta{position:fixed;left:12px;bottom:12px;font-size:12px;opacity:.6;z-index:98}
  </style>
</head>
<body>

<div class="screen">
  <div id="pageCurrent" class="page-current" data-key></div>
  <div id="pageNext" class="page-next" aria-hidden="true"></div>
</div>

<div class="controls">
  <button id="backBtn" class="btn">◀︎ Back</button>
  <button id="nextBtn" class="btn">Next ▶︎</button>
</div>
<div class="meta">
  同期間隔: <span id="intervalMs">100</span>ms
  <!-- ページジャンプ機能追加 -->
  <span style="margin-left:16px;">
    ページ: <input id="pageJumpInput" type="number" min="1" style="width:48px;">
    <button id="pageJumpBtn" class="btn" style="padding:2px 8px;font-size:12px;">移動</button>
  </span>
</div>

<script id="pages-data" type="application/json">
[{"Orange":"","Green":"スポットライト・舞台中央","Pink":"","Text":""},{"Orange":"","Green":"ステージ中央・俯いて座る","Pink":"","Text":"（セリフなし）"},{"Orange":"","Green":"ギフンに向かって","Pink":"","Text":"もし、人生を変えるチャンスがあるとしたら...やってみたいと思いませんか？"},{"Orange":"","Green":"","Pink":"","Text":"（スカウトマン花札取り出し、ギフンに挑戦）"},{"Orange":"","Green":"ブラックアウト","Pink":"","Text":"...借金まみれの俺に、都合のいい話があるわけ....!"},{"Orange":"","Green":"上の間にほぼ全員のプレイヤーは
並んでいる","Pink":"","Text":"（セリフなし）"},{"Orange":"","Green":"","Pink":"","Text":"起きろ。ゲームの始まりだ。"},{"Orange":"","Green":"","Pink":"","Text":"皆さん。ようこそ。これより、公平な競争を行います。
賞金は、456億ウォン。脱落者は即時失格。つまり、『死』です。"},{"Orange":"","Green":"","Pink":"","Text":"嘘だろ？"},{"Orange":"","Green":"","Pink":"","Text":"（セリフは特にないが裏でガヤガヤする）"},{"Orange":"","Green":"舞台暗転後、明転。プロジェクターに巨大な人形の映像が映し出される。ピンクマンたちが整列。重々しいBGMが低く流れる。","Pink":"","Text":"n"},{"Orange":"","Green":"声が反響する。観客席に不気味な沈黙が走る。","Pink":"","Text":"最初のゲームは――『だるまさんがころんだ』です。制限時間内にゴールへ到達してください。動いたものは即脱落となります。"},{"Orange":"","Green":"不安げにざわめきながら列に並ぶ。ピンクマンが監視する。BGMが切り替わり、だるまさんがころんだの童謡が不気味に流れ始める。","Pink":"","Text":"―"},{"Orange":"","Green":"首がカチリと回転してプレイヤーたちを睨む。","Pink":"","Text":"だ〜る〜ま〜さ〜ん〜が〜…こ〜ろ〜ん〜だ！"},{"Orange":"","Green":"思わず動いてしまい、銃声。撃たれた衝撃で崩れ落ちる。","Pink":"","Text":"うわぁぁっ！"},{"Orange":"","Green":"動揺、恐怖で息を殺す。誰も助けられない。","Pink":"","Text":"ひっ……！動くな！"},{"Orange":"","Green":"額に汗を浮かべながらも、冷酷に前へ進む。","Pink":"","Text":"ちっ……お遊びのつもりがマジじゃねえかよ！ ……俺は絶対に生き残ってやる！"},{"Orange":"","Green":"再び振り返る。別のモブがわずかに動いてしまう。","Pink":"","Text":"だ〜る〜ま〜さ〜ん〜が〜…こ〜ろ〜ん〜だ！"},{"Orange":"","Green":"撃たれ、絶叫しながら倒れる。場が血の気を失う。","Pink":"","Text":"や、やめ――！"},{"Orange":"","Green":"セビョクの手を掴み、勇気を奮い立たせて前へ引っ張る。","Pink":"","Text":"……セビョク！手を！"},{"Orange":"","Green":"怯えながらも必死に進む。二人の絆が強まる瞬間。","Pink":"","Text":"っ……ありがとう。"},{"Orange":"","Green":"さらに数人のモブが射殺される。ピンクマンたちが遺体を無表情に引きずって退場させる。","Pink":"","Text":"だ〜る〜ま〜さ〜ん〜が〜…こ〜ろ〜ん〜だ！"},{"Orange":"","Green":"息を潜め、必死に耐える。BGMと銃声で恐怖を増幅。","Pink":"","Text":"―"},{"Orange":"","Green":"緊迫したSEが鳴り響く。照明が赤に点滅し始める。","Pink":"","Text":"―"},{"Orange":"","Green":"声を張り上げ、全力で駆ける。","Pink":"","Text":"走れっ！ゴールまであと少しだ！"},{"Orange":"","Green":"叫びながらゴールに飛び込む。","Pink":"","Text":"うわぁぁっ！間に合え――！"},{"Orange":"","Green":"最後の一人がゴールした瞬間、赤い照明が強く点灯。制限時間終了を告げるアラーム音。","Pink":"","Text":"―"},{"Orange":"","Green":"無感情に告げる。","Pink":"","Text":"……時間終了。生存者のみ、次のゲームに進みます。"},{"Orange":"","Green":"ピンクマンにより運ばれ、残骸のように片付けられる。","Pink":"","Text":"―"},{"Orange":"","Green":"緊迫した音響を残し、ブラックアウト。観客席に重苦しい沈黙。","Pink":"","Text":"―"},{"Orange":"","Green":"","Pink":"","Text":"（休憩所・食事シーンなど。人間関係の深堀り）"},{"Orange":"","Green":"","Pink":"","Text":"プレイヤー主役級全員登場。あぐらかいで食事を取ってる雰囲気"},{"Orange":"","Green":"","Pink":"","Text":"家族、いるの？"},{"Orange":"","Green":"","Pink":"","Text":"北に...弟が一人...。迎えにいかなくちゃ"},{"Orange":"","Green":"","Pink":"","Text":"私にできること、あったら言って。（うんって頷く）"},{"Orange":"","Green":"","Pink":"","Text":"どうして参加したんだ？"},{"Orange":"","Green":"","Pink":"","Text":"妻と子がいます。でも、韓国では...働いても....足りないんです。"},{"Orange":"","Green":"","Pink":"","Text":"昔からお前は頭が良かった。でも、これは違うだろ...."},{"Orange":"","Green":"","Pink":"","Text":"勝たなきゃ意味がない。ここには、正解も、倫理もないんだよ"},{"Orange":"","Green":"","Pink":"","Text":"こうして床に座って飯を食うと...子供の頃を思い出すよ。"},{"Orange":"","Green":"主役級（ギフン・サンウ・セビョク・アリ・イルナム・ジヨン）＋モブ数名でチーム編成。対するはドクス率いるモブチーム。BGMで緊迫感を演出。","Pink":"","Text":"―"},{"Orange":"","Green":"ゆっくりと深呼吸。チームメンバーを見回し、士気を高める。","Pink":"","Text":"昔、村祭りで綱引きをしたことがあってねぇ…。力より心を合わせることが大事なんだ。"},{"Orange":"","Green":"高笑いしながら挑発。モブチームの士気を鼓舞。","Pink":"","Text":"お前ら、全員弱そうだなw 今ここで全員、奈落に落ちろ！！"},{"Orange":"","Green":"全員で一斉に綱を引き合う。緊張感MAX。","Pink":"","Text":"引けぇぇ！！"},{"Orange":"","Green":"効果音：綱がきしむ音、足元の砂や木の軋む音。両軍が必死に力を込める。","Pink":"","Text":"―"},{"Orange":"","Green":"息を切らしながら指示。チーム全員に目線で合図。","Pink":"","Text":"いいか…一歩前に出るんだ。相手がよろけたとき、一気に引け！！"},{"Orange":"","Green":"一斉に力を込める。観客席からの歓声・緊迫SE。","Pink":"","Text":"今だ！引けーー！！"},{"Orange":"","Green":"バランスを崩し、必死に踏ん張るが次々と落下。ガラスや足場の効果音で迫力演出。","Pink":"","Text":"―"},{"Orange":"","Green":"奈落に落下。悲鳴と崩れる音。","Pink":"","Text":"うわぁぁっ！！"},{"Orange":"","Green":"落下中、必死に手を伸ばすが間に合わない。","Pink":"","Text":"助けてくれ……！"},{"Orange":"","Green":"チームメンバーとお互いに目を合わせ、安堵の表情。","Pink":"","Text":"生き延びた…"},{"Orange":"","Green":"息を整えながら、仲間を労う。","Pink":"","Text":"よくやった…全員無事だ。"},{"Orange":"","Green":"無表情で告げる。落下したモブたちは運ばれて退場。","Pink":"","Text":"勝者チーム、残留。"},{"Orange":"","Green":"緊迫した音響が残り、勝利の余韻と敗北の悲鳴が交錯。舞台が暗転。","Pink":"","Text":"―"},{"Orange":"","Green":"","Pink":"","Text":""},{"Orange":"","Green":"舞台下手、毛布に包まり横たわる","Pink":"","Text":"……眠れる？"},{"Orange":"","Green":"ジヨンをちらりと見て、微笑む","Pink":"","Text":"あんたこそ。"},{"Orange":"","Green":"お互いに小さく笑う。遠くで観客のざわめきが微かに聞こえる","Pink":"","Text":"（静かな間）"},{"Orange":"","Green":"布団に寄りかかりながらギフンを見る","Pink":"","Text":"……ありがとう。助けてくれて。"},{"Orange":"","Green":"視線を伏せる。場の空気が重く沈む","Pink":"","Text":"生き延びなきゃ……意味がないからな。"},{"Orange":"","Green":"照明がゆっくりフェードアウト","Pink":"","Text":"―"},{"Orange":"","Green":"","Pink":"","Text":"(暗転→スポットライトが二人だけを照らす)"},{"Orange":"","Green":"","Pink":"","Text":"ねぇ...この先あなたが生き残って。弟に会いに言ってほしい。"},{"Orange":"","Green":"","Pink":"","Text":"何を言っているのよ、一緒に..."},{"Orange":"","Green":"","Pink":"","Text":"(ジヨン、ゆっくりと背中を向けて立ち上がり、ピンクマンに歩み出る)"},{"Orange":"","Green":"","Pink":"","Text":"脱落。"},{"Orange":"","Green":"","Pink":"","Text":"(ピンクマン、銃を向ける。銃声SE→ジヨン崩れ落ちる)"},{"Orange":"","Green":"","Pink":"","Text":"ジヨン！！(涙)"},{"Orange":"","Green":"小さく、しかし真剣に告げる","Pink":"","Text":"ねぇ……もしこの先、あなたが生き残ったら――弟に会いに行ってほしい。"},{"Orange":"","Green":"驚き、涙をこらえながら見つめる","Pink":"","Text":"何を言っているのよ……そんなの、一緒に――"},{"Orange":"","Green":"首を振り、微笑む","Pink":"","Text":"私は……ずっと生きる理由を探してきた。でも、あなたには弟がいる。守る人がいる。だから……お願い。"},{"Orange":"","Green":"声を震わせ、感情を押し殺しきれない","Pink":"","Text":"そんな勝手なこと言わないで……！私だって……一緒にいたいのに……！"},{"Orange":"","Green":"そっと手を伸ばし、セビョクの手を握る","Pink":"","Text":"ありがとう。……友達になってくれて。"},{"Orange":"","Green":"ゆっくり背を向け、ピンクマンへ歩み出す","Pink":"","Text":"―"},{"Orange":"","Green":"銃を構える。短い沈黙の後、銃声SE","Pink":"","Text":"脱落。"},{"Orange":"","Green":"崩れ落ちる","Pink":"","Text":"―"},{"Orange":"","Green":"駆け寄り、涙で叫ぶ","Pink":"","Text":"ジヨン！！ いやぁぁぁぁ！！！"},{"Orange":"","Green":"照明が冷たく落ち、VIP席から乾いた拍手が響く","Pink":"","Text":"―"},{"Orange":"","Green":"舞台暗転後、巨大なガラスの橋が浮かぶ。VIP席が上手に見下ろす。緊迫の音楽が低く流れる。","Pink":"","Text":"――第3ゲームは『飛び石渡り』。一歩間違えれば奈落の底へ…"},{"Orange":"","Green":"足元を見て震える。膝がガクガク。手すりもない。","Pink":"","Text":"こ、こんな高さ…無理だ…足がすくむ…！"},{"Orange":"","Green":"意を決して飛び乗るが、一歩目でガラスが微かにきしむ。","Pink":"","Text":"俺が先に行く…！誰かがやらなきゃ…！"},{"Orange":"","Green":"バランスを崩し、落下寸前で必死に手を伸ばすが失敗。落下演出。悲鳴が響く。","Pink":"","Text":"うわっ！？"},{"Orange":"","Green":"足場を凝視。冷や汗。心臓の鼓動が大きく聞こえる演出。","Pink":"","Text":"どっちが安全なんだ…!? 目で見てもわからない…！"},{"Orange":"","Green":"冷酷な表情でモブを押す仕草。背後の恐怖と焦燥感を強調。","Pink":"","Text":"悩んでる暇はない。確率だ。お前が前に行け！"},{"Orange":"","Green":"抵抗するが押され、ガラスが割れる音。断末魔の叫びと共に落下。","Pink":"","Text":"や、やめろっ！俺はまだ――！"},{"Orange":"","Green":"怒りと恐怖で顔を歪める。","Pink":"","Text":"サンウ！なんてことを…！"},{"Orange":"","Green":"無表情。足元に落ちたモブの影を一瞥する。","Pink":"","Text":"ここは綺麗事で生き残れる場所じゃない。"},{"Orange":"","Green":"慎重に足場を確かめ、一歩ずつ前進する。全身に緊張が走る。","Pink":"","Text":"…光の反射が違う？これかもしれない！"},{"Orange":"","Green":"ガラスが割れる音と共に暗転。落下演出。","Pink":"","Text":"家族に…会え……"},{"Orange":"","Green":"両手を伸ばし絶叫。舞台全体に響く悲鳴。","Pink":"","Text":"アリィィィィーーッ！！！"},{"Orange":"","Green":"足がすくみ、震えながら立ち止まる。前進できず苦悶。","Pink":"","Text":"嫌だ…こんなの、地獄だ…！"},{"Orange":"","Green":"舞台上にタイマーのライトが点滅。緊張感を強調。","Pink":"","Text":"――制限時間は迫っている。進まなければ全員、失格だ。"},{"Orange":"","Green":"背筋を伸ばし、淡々と前進。冷徹さを際立たせる。","Pink":"","Text":"結局、生き残れるのは運を引いた者だけだ。"},{"Orange":"","Green":"足場の途中で呆然。恐怖で立ちすくむ。","Pink":"","Text":"どうして…どうしてこんなゲームに…！"},{"Orange":"","Green":"必死に前進するが、ガラスの不安定さに手を滑らせる。落下寸前で踏ん張る。","Pink":"","Text":"俺も行くしかない…！"},{"Orange":"","Green":"心を奮い立たせ、慎重に足場を渡る。息が荒くなる。","Pink":"","Text":"俺は…絶対生き残る…！"},{"Orange":"","Green":"失敗して落下。断末魔が暗転に消える。","Pink":"","Text":"もう…終わりだ…！"},{"Orange":"","Green":"息を整え、警戒心を強める。","Pink":"","Text":"気を抜くな…次も危険だ…！"},{"Orange":"","Green":"ガラスの上で足が震え、進めずに立ちすくむ。","Pink":"","Text":"あああ…怖い…！"},{"Orange":"","Green":"最後のステップに踏み出す。舞台の緊張が最高潮。","Pink":"","Text":"もう少しだ…絶対に…"},{"Orange":"","Green":"ゆっくりと背後で発表。VIP席が拍手。暗転。","Pink":"","Text":"勝者はわずか3名…"},{"Orange":"","Green":"観客に向かって低く告げ、舞台全体を暗くする。","Pink":"","Text":"――次が最後のゲームだ。"},{"Orange":"","Green":"スポットライトが二人を照らす。周囲は暗闇、格闘場のような静寂。","Pink":"","Text":"ファイナルゲーム、『イカゲーム』。相手を制圧したほうが勝利です。"},{"Orange":"","Green":"顔を歪め、必死の表情。握り拳が震える。","Pink":"","Text":"殺せよ。そうしないと……終わらないだろ？"},{"Orange":"","Green":"一瞬目を閉じ、心の葛藤が表情に出る。","Pink":"","Text":"……買っても意味ないだろ。こんなやり方じゃ……"},{"Orange":"","Green":"指をさしながら言う。涙と怒りが交錯する。","Pink":"","Text":"せめて……お母さんに……お金を……"},{"Orange":"","Green":"呆然と立ち尽くす。過去の記憶や家族の顔がフラッシュバック。","Pink":"","Text":"……"},{"Orange":"","Green":"二人が互いに突進、拳や蹴りの打撃音。照明が激しく揺れる。","Pink":"","Text":"―"},{"Orange":"","Green":"憎悪の叫び。ギフンに突進し、組み合う。","Pink":"","Text":"お前なんかに、俺の人生……！"},{"Orange":"","Green":"全身で反撃。汗と血が飛ぶ緊迫の格闘。","Pink":"","Text":"俺は……誰も傷つけずには……生きられないのか！"},{"Orange":"","Green":"決意を固め、サンウの動きを封じる。","Pink":"","Text":"これで終わらせる……誰も死なせたくない……"},{"Orange":"","Green":"最後の力で反撃するが、ギフンに制圧される。","Pink":"","Text":"まだ……俺を止められると思うのか……！"},{"Orange":"","Green":"無表情で告げる。スポットライトがギフンだけを照らす。孤独感を強調。","Pink":"","Text":"勝者、ギフン。"},{"Orange":"","Green":"激しく息をつき、両手を握りしめる。拳に力が入る。","Pink":"","Text":"こんなの……遊びじゃない……！"},{"Orange":"","Green":"ブラックアウト。観客席からの拍手SEが徐々に大きくなる。VIP席の拍手を特に強調。","Pink":"","Text":"―"},{"Orange":"","Green":"全暗転、ギフンのみがスポットライトで浮かぶ。孤独と勝利の複雑な感情を表現。","Pink":"","Text":"人は、何を失えば『人間』ではなくなるのか。欲望と絶望が交差する先に、勝者はいた。"},{"Orange":"","Green":"一人立ち尽くす。呼吸音だけが響く。勝利の重みと虚無を象徴。","Pink":"","Text":"……"},{"Orange":"","Green":"冷たい風の音、遠くで銃声や叫び声が残響として流れる。静けさと余韻を演出。","Pink":"","Text":"―"}]
</script>

<script>
const DB_BASE = 'https://couud-dashboard-default-rtdb.firebaseio.com';
const DB_KEY  = 'nunhoa:1';
const POLL_MS = 100;
const DB_URL = `${DB_BASE}/${encodeURIComponent(DB_KEY)}.json`;

let rawPages = [];
try { 
  // JSONデータの制御文字対策
  let jsonText = document.getElementById('pages-data').textContent || '[]';
  // 制御文字（\u000Aなど）を除去
  jsonText = jsonText.replace(/[\u0000-\u001F]+/g, ''); 
  rawPages = JSON.parse(jsonText); 
} catch(e) { 
  rawPages = []; 
  console.error(e); 
}
const pages = Array.isArray(rawPages) ? rawPages : [];

let currentIndex = 0;
let lastRemoteTs = 0;
const elCurrent = document.getElementById('pageCurrent');
const elNext = document.getElementById('pageNext');
const elInterval = document.getElementById('intervalMs'); elInterval.textContent = POLL_MS;

function escapeHtml(s) { return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function renderPage(index) {
  index = ((index % pages.length) + pages.length) % pages.length;
  const cur = pages[index];
  const nxt = pages[(index + 1) % pages.length];

  // ページデータが存在しない場合は空表示
  if (!cur) {
    elCurrent.innerHTML = '';
  } else {
    elCurrent.innerHTML = Object.keys(cur)
      .filter(k => k !== 'Text' && cur[k] && cur[k].trim() !== '')
      .map(k => `<div class="block blk-${k}"><div class="text">${escapeHtml(cur[k])}</div></div>`)
      .join('') +
      `<div class="block blk-Text" style="flex-grow:1;"><div class="text">${escapeHtml(cur.Text||'')}</div></div>`;
  }

  if (!nxt) {
    elNext.innerHTML = '';
  } else {
    elNext.innerHTML = `<div class="text">${escapeHtml(nxt.Text||'')}</div>`;
  }
  currentIndex = index;
}

async function writeIndexToFirebase(index){
  try{
    await fetch(DB_URL, {
      method:'PATCH',
      headers:{'Content-Type':'application/json'},
      body:JSON.stringify({index:index, updatedAt:Date.now()})
    });
  }catch(e){console.error(e);}
}

function goNext(){
  const next = (currentIndex + 1) % pages.length;
  renderPage(next);
  writeIndexToFirebase(next);
}
function goPrev(){
  const prev = (currentIndex - 1 + pages.length) % pages.length;
  renderPage(prev);
  writeIndexToFirebase(prev);
}

document.getElementById('nextBtn').addEventListener('click', goNext);
document.getElementById('backBtn').addEventListener('click', goPrev);
window.addEventListener('keydown', e=>{if(e.key==='ArrowRight') goNext(); if(e.key==='ArrowLeft') goPrev();});

// ページジャンプ機能
const pageJumpInput = document.getElementById('pageJumpInput');
const pageJumpBtn = document.getElementById('pageJumpBtn');
if (pageJumpBtn && pageJumpInput) {
  pageJumpBtn.addEventListener('click', () => {
    const val = parseInt(pageJumpInput.value, 10);
    if (!isNaN(val) && val >= 1 && val <= pages.length) {
      renderPage(val - 1);
      writeIndexToFirebase(val - 1);
    }
  });
  // Enterキーでもジャンプ
  pageJumpInput.addEventListener('keydown', e => {
    if (e.key === 'Enter') pageJumpBtn.click();
  });
}

async function fetchRemote(){
  try{
    const res = await fetch(DB_URL + '?t=' + Date.now(), {cache:'no-store', mode:'cors'});
    if(!res.ok) return;
    const data = await res.json();
    if(!data) return;
    const remoteIndex = (typeof data.index === 'number') ? data.index : null;
    const remoteTs = (typeof data.updatedAt === 'number') ? data.updatedAt : 0;
    if(remoteTs > lastRemoteTs && remoteIndex !== null && remoteIndex !== currentIndex){
      lastRemoteTs = remoteTs;
      renderPage(remoteIndex);
    }
  }catch(e){console.error(e);}
}

if(pages.length){ renderPage(0); }
setInterval(fetchRemote, POLL_MS);
</script>

</body>
</html>
